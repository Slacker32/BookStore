@{
    Layout = null;
}

@model BooksShopSite.Models.BookCurrencyViewModel

<!DOCTYPE html>

<html>
<head>
    <title>BookStore</title>
    <meta name="viewport" content="width=device-width" />
    <link type="text/css" rel="stylesheet" href="../../Content/Site.css" />
    @Styles.Render("~/Content/css")
    <style>
        .modal-content {
            width: 600px !important;
            margin: 30px auto !important;
        }
    </style>
</head>
<body>
    <div>
        
        <h1 class="text"><i><a href="/Home/Index">BookStore</a></i></h1>
        <table class="filter">
            <tr>
                <td>
                    @using (Html.BeginForm("SearchBookAsync", "Home", FormMethod.Post))
                    {
                        @Html.TextBox("searchValue", null, new { placeholder = "Search string", onchange = "this.form.submit();", @class = "form-control", style = "width: 99%; height: 30px" })
                   }
                </td>
                <td width="130" align="left">
                    
                    @using (Html.BeginForm("SetCurrency", "Home", FormMethod.Post))
                    {
                        <div>
                            Currency:
                            @Html.DropDownListFor(x => x.CurrencyView.SelectedCurrency, Model.CurrencyView.Currencies, new {onchange = "this.form.submit();"})
                        </div>
                    }
                </td>
                <td width="25" align="center"><a href="/Home/Backet">Backet</a></td>
            </tr>
        </table>
        <table class="data">
            <tr>
                <th>Author</th>
                <th>Book title</th>
                <th>The year of publishing</th>
                <th>Price</th>
                <th>Format</th>
                <th></th>
                <th></th>
            </tr>
            @if (Model.BooksView != null)
            {
                foreach (var b in Model.BooksView)
                 {
                     <tr>
                         <td>
                             <p>@b.Authors</p></td>
                         <td>
                             <p>@b.Name</p></td>
                         <td align="center">
                             <p>@b.Year.ToString("yyyy")</p></td>
                         <td>
                             <p>@b.Price</p></td>
                         <td>
                             <p>@b.Format</p></td>
                         <td>
                             <p><a href="/Home/PreviewAsync/@b.BookId">Preview</a>
                             </p></td>
                         <td>
                             <p><a href="/Home/Buy/@b.BookId" class="modal-link">Buy</a>
                             </p></td>
                     </tr>
                 }
            }
        </table>
    </div>
        
    @Scripts.Render("~/bundles/jquery")
    @Scripts.Render("~/bundles/bootstrap")

    <div id="modal-container" class="modal fade" tabindex="-1" role="dialog">
        <div class="modal-content">
        </div>
    </div>

    <script type="text/javascript">
        $(function () {
            // Initialize numeric spinner input boxes
            //$(".numeric-spinner").spinedit();

            // Initalize modal dialog
            // attach modal-container bootstrap attributes to links with .modal-link class.
            // when a link is clicked with these attributes, bootstrap will display the href content in a modal dialog.
            $('body').on('click', '.modal-link', function (e) {
                e.preventDefault();
                $(this).attr('data-target', '#modal-container');
                $(this).attr('data-toggle', 'modal');
            });

            // Attach listener to .modal-close-btn's so that when the button is pressed the modal dialog disappears
            $('body').on('click', '.modal-close-btn', function () {
                $('#modal-container').modal('hide');
            });

            //clear modal cache, so that new content can be loaded
            $('#modal-container').on('hidden.bs.modal', function () {
                $(this).removeData('bs.modal');
            });

            $('#CancelModal').on('click', function () {
                return false;
            });
        });
    </script>


</body>
</html>